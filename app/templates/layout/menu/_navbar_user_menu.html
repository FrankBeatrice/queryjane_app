{% load entrepreneur_tags notifications %}
<ul class="nav navbar-nav navbar-right">

    {% get_user_notifications_count user as user_notifications_count %}
    {% get_new_user_notifications_count user as new_user_notifications_count %}
    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" {% if user_notifications_count %}href="#" id="navbarDropdownNotificationsLink" data-toggle="dropdown"{% endif %} title="{% if user_notifications_count %}Notificaciones{% else %}No hay nuevas notificaciones{% endif %}">

        {% if user_notifications_count %}
            <i class="fa fa-bell" aria-hidden="true"></i>
        {% else %}
            <i class="fa fa-bell-slash" aria-hidden="true"></i>
        {% endif %}

            {% if new_user_notifications_count %}({{ new_user_notifications_count }}){% endif %}
        </a>

        {% get_recent_user_notifications user as recent_user_notifications %}
        <ul class="dropdown-menu notification-list"  aria-labelledby="navbarDropdownNotificationsLink">
        {% for notification in recent_user_notifications %}
            <li class="dropdown-item" data-toggle="modal" data-target="#generalModalMessage">
                <a class="qjane-notification-link {% if notification.answered %}qjane-answered-notification{% else %}qjane-pending-notification{% endif %}" href="javascript:void(0)" data-notification-url="{% url 'account:ajax_post_notification_load' notification.pk  %}">
                    <i class="fa {% if notification.was_seen %}fa-eye{% else %}fa-eye-slash{% endif %}" aria-hidden="true" title="{% if notification.was_seen %}Notificación revisada{% else %}Nueva notificación{% endif %}"></i>
                    {{ notification }}
                </a>
            </li>
        {% endfor %}

        {% if recent_user_notifications.count > 10 %}
            <li class="dropdown-item"><a href="#">View all</a></li>
        {% endif %}
        </ul>
    </li>

    {% comment %}
    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMessagesLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fa fa-envelope" aria-hidden="true"></i>
        </a>

        <ul class="dropdown-menu"  aria-labelledby="navbarDropdownMessagesLink">
            <li class="dropdown-item"><a href="#">Conversación 1</a></li>
            <li class="dropdown-item"><a href="#">Conversación 2</a></li>
            <li class="dropdown-item"><a href="#">Conversación 3</a></li>
            <li class="dropdown-item"><a href="#">Conversación 4</a></li>
            <li class="dropdown-item"><a href="#">Conversación 5</a></li>
            <li class="dropdown-item"><a href="#">Ver todas</a></li>
        </ul>
    </li>
    {% endcomment %}

    <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownSettingsLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            {{ user.first_name }}
            <i class="fa fa-chevron-down fa-fw" aria-hidden="true"></i>
        </a>

        <ul class="dropdown-menu"  aria-labelledby="navbarDropdownSettingsLink">
            <li class="dropdown-item">
                <a href="{% url 'professional_detail' user.professionalprofile.slug %}" class="clearfix">
                    <span class="pull-left">Profile</span>
                    <i class="fa fa-user pull-right" aria-hidden="true"></i>
                </a>
            </li>

            <li class="dropdown-item">
                <a href="{% url 'account:profile_update' %}" class="clearfix">
                    <span class="pull-left">Account</span>
                    <i class="fa fa-cog pull-right" aria-hidden="true"></i>
                 </a>
             </li>

            <li class="dropdown-item">
                <a href="{% url 'entrepreneur:venture_form' %}" class="clearfix">
                    <span class="pull-left">New company</span>
                    <i class="fa fa-briefcase pull-right" aria-hidden="true"></i>
                </a>
            </li>
        {% get_user_venture_memberships user as user_venture_memberships %}

        {% if user_venture_memberships %}
        {% for membership in user_venture_memberships %}
            <li class="dropdown-item"><a href="{{ membership.venture.get_absolute_url }}">{{ membership.venture }}</a></li>
        {% endfor %}
        {% endif %}
            <li class="dropdown-item">
                <a href="{% url 'user_logout' %}" class="clearfix">
                    <span class="pull-left">Log out</span>
                    <i class="fa fa-power-off pull-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </li>
</ul>

<!-- Modal -->
<div class="modal fade" id="generalModalMessage" tabindex="-1" role="dialog" aria-labelledby="generalModalMessage" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content"></div>
    </div>
</div>

